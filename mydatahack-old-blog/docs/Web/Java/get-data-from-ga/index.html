<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Web/Java/get-data-from-ga" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">How To Get Data From Google Analytics With Java | MyDatahack</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://takahirohonda.github.io/mydatahack-old-blog/docs/Web/Java/get-data-from-ga"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How To Get Data From Google Analytics With Java | MyDatahack"><meta data-rh="true" name="description" content="In the previous post, we discussed a strategy to ingest Google Analytics data and presented the Python code example (How To Get Data From Google Analytics With Python). Generally speaking, I prefer using Python code to ingest API data, however, every once in a while, we get requested to write a code in a compiled language like Java for whatever reason. So, here is GA data ingestion code example in Java."><meta data-rh="true" property="og:description" content="In the previous post, we discussed a strategy to ingest Google Analytics data and presented the Python code example (How To Get Data From Google Analytics With Python). Generally speaking, I prefer using Python code to ingest API data, however, every once in a while, we get requested to write a code in a compiled language like Java for whatever reason. So, here is GA data ingestion code example in Java."><link data-rh="true" rel="icon" href="/mydatahack-old-blog/img/icon-circle.png"><link data-rh="true" rel="canonical" href="https://takahirohonda.github.io/mydatahack-old-blog/docs/Web/Java/get-data-from-ga"><link data-rh="true" rel="alternate" href="https://takahirohonda.github.io/mydatahack-old-blog/docs/Web/Java/get-data-from-ga" hreflang="en"><link data-rh="true" rel="alternate" href="https://takahirohonda.github.io/mydatahack-old-blog/docs/Web/Java/get-data-from-ga" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/mydatahack-old-blog/blog/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mydatahack-old-blog/blog/atom.xml" title="MyDatahack Atom Feed">



<link rel="alternate" type="application/rss+xml" href="/mydatahack-old-blog/web-technologies/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mydatahack-old-blog/web-technologies/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/mydatahack-old-blog/data-engineering/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mydatahack-old-blog/data-engineering/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/mydatahack-old-blog/data-science/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mydatahack-old-blog/data-science/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/mydatahack-old-blog/infrastructure/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mydatahack-old-blog/infrastructure/atom.xml" title="MyDatahack Atom Feed"><link rel="stylesheet" href="/mydatahack-old-blog/assets/css/styles.2668ea1a.css">
<script src="/mydatahack-old-blog/assets/js/runtime~main.65edbf1e.js" defer="defer"></script>
<script src="/mydatahack-old-blog/assets/js/main.ffa8a442.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mydatahack-old-blog/"><div class="navbar__logo"><img src="/mydatahack-old-blog/img/icon-circle.png" alt="MyDatahack Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mydatahack-old-blog/img/icon-circle.png" alt="MyDatahack Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MyDatahack</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mydatahack-old-blog/docs/">Blogs</a><a class="navbar__item navbar__link" href="/mydatahack-old-blog/web-technologies">Web Technologies</a><a class="navbar__item navbar__link" href="/mydatahack-old-blog/data-engineering">Data Engineering</a><a class="navbar__item navbar__link" href="/mydatahack-old-blog/data-science">Data Science</a><a class="navbar__item navbar__link" href="/mydatahack-old-blog/infrastructure">Infrastructure</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/takahirohonda" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mydatahack-old-blog/docs/">index</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mydatahack-old-blog/docs/category/etl">ETL</a><button aria-label="Expand sidebar category &#x27;ETL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mydatahack-old-blog/docs/category/data-ingestion">Data Ingestion</a><button aria-label="Expand sidebar category &#x27;Data Ingestion&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mydatahack-old-blog/docs/category/infrastructure">Infrastructure</a><button aria-label="Expand sidebar category &#x27;Infrastructure&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/mydatahack-old-blog/docs/category/web">Web</a><button aria-label="Collapse sidebar category &#x27;Web&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mydatahack-old-blog/docs/category/net">.Net</a><button aria-label="Expand sidebar category &#x27;.Net&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mydatahack-old-blog/docs/category/sitecore">Sitecore</a><button aria-label="Expand sidebar category &#x27;Sitecore&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mydatahack-old-blog/docs/category/frontend">Frontend</a><button aria-label="Expand sidebar category &#x27;Frontend&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mydatahack-old-blog/docs/category/nodejs">Node.js</a><button aria-label="Expand sidebar category &#x27;Node.js&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mydatahack-old-blog/docs/category/java">Java</a><button aria-label="Collapse sidebar category &#x27;Java&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mydatahack-old-blog/docs/Web/Java/automate-table-column-comparison">Automate Source And Target Table Column Comparison With Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mydatahack-old-blog/docs/Web/Java/automate-sf-table-creation">Automate Salesforce Table Creation With Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mydatahack-old-blog/docs/Web/Java/get-data-from-ga">How To Get Data From Google Analytics With Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mydatahack-old-blog/docs/Web/Java/no-compiler-error">Fixing No Compiler is Provided in this Environment Error for Maven Project with Eclipse</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mydatahack-old-blog/docs/category/git">Git</a><button aria-label="Expand sidebar category &#x27;Git&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mydatahack-old-blog/docs/category/chatgpt-generated">ChatGPT Generated</a><button aria-label="Expand sidebar category &#x27;ChatGPT Generated&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/mydatahack-old-blog/docs/doc-example/intro">doc-example</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mydatahack-old-blog/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/mydatahack-old-blog/docs/category/web"><span itemprop="name">Web</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/mydatahack-old-blog/docs/category/java"><span itemprop="name">Java</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How To Get Data From Google Analytics With Java</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>How To Get Data From Google Analytics With Java</h1>
<p>In the previous post, we discussed a strategy to ingest Google Analytics data and presented the Python code example (How To Get Data From Google Analytics With Python). Generally speaking, I prefer using Python code to ingest API data, however, every once in a while, we get requested to write a code in a compiled language like Java for whatever reason. So, here is GA data ingestion code example in Java.</p>
<p>For authentication, you need to download Google Analytics API Client Library for Java. The code below is based on the Google documentation here. The report extraction strategy is slightly different from the python code. This example allows you to specify the dimensions and metrics along side with other arguments while the previous example has multiple reports hard coded in the main method. With this strategy, you have a flexibility of changing the report dimensions and metrics without touching the source code. If you need to export multiple reports, you can execute the jar file with different arguments. The code will download data as json and convert to csv in a structured format ready to be uploaded into a relational database.</p>
<p>Execution
Complie the code into an executable jar file and run the command with arguments.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -jar GA_Data_Export.jar &lt;key dir e.g. ./OUA-Key.p12&gt; &lt;service email&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;json file path e.g. ./ga_export.json&gt; &lt;csv file path e.g. ./ga_export.csv&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;metrics e.g. ga:users,ga:sessions,ga:bounceRate&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dimensions e.g. ga:channelGrouping,ga:date&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;start-date e.g. 7daysAgo or 2017-01-20&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;end-date e.g. today or 2017-12-25&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Code</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class GoogleAnalyticsAuth {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String APPLICATION_NAME = &quot;GA Data Ingestion&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final JsonFactory JSON_FACTORY = GsonFactory.getDefaultInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String KEY_FILE_LOCATION = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String apiEmail = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String jsonFilePath = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String csvFilePath=&quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KEY_FILE_LOCATION = args[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        apiEmail = args[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jsonFilePath = args[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        csvFilePath = args[3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String dimsMetric = args[4];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String dimsDimension = args[5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String startDate = args[6];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String endDate = args[7];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Analytics analytics = initializeAnalytic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String profile = getFirstProfileId(analytics);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;First Profile Id is: &quot; + profile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            GaData result = getResults(analytics, profile, dimsMetric, dimsDimension, startDate, endDate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generateJsonFile(result, jsonFilePath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generateCsvFile(result, csvFilePath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // System.out.println(json.getString(&quot;rows&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // System.out.println(generateHeaderString(result));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Get Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static GaData getResults(Analytics analytics, String profileId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String dimsMetric, String dimsDimension,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String startDate, String endDate) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Query the Core Reporting API for the number of sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // String dimsDate = &quot;,ga:date, ga:hour&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Get get = analytics.data().ga().get(&quot;ga:&quot; + profileId, startDate, endDate, dimsMetric);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        get.setDimensions(dimsDimension);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        get.setMaxResults(10000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return get.execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String generateHeaderString(GaData results) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String columns = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;ColumnHeaders&gt; header = results.getColumnHeaders();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;ColumnHeaders&gt; iter = header.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (iter.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            columns += iter.next().getName().replace(&quot;ga:&quot;,  &quot;&quot;) + &quot;,&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return columns.substring(0, columns.length() - 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void generateCsvFile(GaData results, String csvFilePath) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (1) Prepare files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FileWriter fWriter = new FileWriter(csvFilePath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BufferedWriter bWriter = new BufferedWriter(fWriter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrintWriter out = new PrintWriter(bWriter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (2) Write header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.println(generateHeaderString(results));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (3) Get data from GaData object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            List&lt;List&lt;String&gt;&gt; rows = results.getRows();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Iterator&lt;List&lt;String&gt;&gt; iter = rows.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (iter.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Iterator&lt;String&gt; iter2 = iter.next().iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                String row = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                while (iter2.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    row += iter2.next() + &quot;,&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                out.println(row.substring(0, row.length() - 1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // System.out.println(row.substring(0, row.length() - 1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } // end of first while loop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (4) Close the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;CSV File has been created.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Problem with csv file IO operation: &quot; + e.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void generateJsonFile(GaData results, String filePath) throws JSONException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (1) Prepare files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FileWriter fWriter = new FileWriter(filePath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BufferedWriter bWriter = new BufferedWriter(fWriter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrintWriter out = new PrintWriter(bWriter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (2) Create JSON Object and write into the file with indentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            JSONObject json = new JSONObject(results);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.println(json.toString(4));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (3) Close the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;JSON File has been created.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Problem with JSON file IO operation: &quot; + e.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // AUTHENTICATION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Initializes an Analytics service object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return An authorized Analytics service object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws IOException</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws GeneralSecurityException</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static Analytics initializeAnalytic() throws GeneralSecurityException, IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HttpTransport httpTransport = GoogleNetHttpTransport.newTrustedTransport();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GoogleCredential credential = new GoogleCredential.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setTransport(HTTP_TRANSPORT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setJsonFactory(JSON_FACTORY)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setServiceAccountId(apiEmail)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setServiceAccountScopes(Arrays.asList(AnalyticsScopes.ANALYTICS_READONLY))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setServiceAccountPrivateKeyFromP12File(new File(KEY_FILE_LOCATION)).build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /* Using JSON file for secret key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GoogleCredential credential = GoogleCredential.fromStream(new FileInputStream(KEY_FILE_LOCATION))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        .createScoped(AnalyticsScopes.all());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Analytics.Builder(httpTransport, JSON_FACTORY, credential)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setApplicationName(APPLICATION_NAME).build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String getFirstProfileId(Analytics analytics) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Get the first view (profile) ID for the authorized user.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String profileId = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Query for the list of all accounts associated with the service account.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Accounts accounts = analytics.management().accounts().list().execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (accounts.getItems().isEmpty()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          System.err.println(&quot;No accounts found&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          String firstAccountId = accounts.getItems().get(0).getId();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          // Query for the list of properties associated with the first account.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Webproperties properties = analytics.management().webproperties()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .list(firstAccountId).execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          if (properties.getItems().isEmpty()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.err.println(&quot;No Webproperties found&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String firstWebpropertyId = properties.getItems().get(0).getId();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Query for the list views (profiles) associated with the property.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Profiles profiles = analytics.management().profiles()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .list(firstAccountId, firstWebpropertyId).execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (profiles.getItems().isEmpty()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              System.err.println(&quot;No views (profiles) found&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              // Return the first (view) profile associated with the property.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              profileId = profiles.getItems().get(0).getId();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return profileId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(2017-11-11)</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mydatahack-old-blog/docs/Web/Java/automate-sf-table-creation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Automate Salesforce Table Creation With Java</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mydatahack-old-blog/docs/Web/Java/no-compiler-error"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Fixing No Compiler is Provided in this Environment Error for Maven Project with Eclipse</div></a></nav></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mydatahack-old-blog/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/takahirohonda" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 MDH.</div></div></div></footer></div>
</body>
</html>