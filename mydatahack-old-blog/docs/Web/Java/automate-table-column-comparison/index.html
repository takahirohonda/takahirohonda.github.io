<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Web/Java/automate-table-column-comparison" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Automate Source And Target Table Column Comparison With Java | MyDatahack</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mydatahack.com/docs/Web/Java/automate-table-column-comparison"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Automate Source And Target Table Column Comparison With Java | MyDatahack"><meta data-rh="true" name="description" content="The code uses JDBC for both target and source database connections. You need to compile the code with appropriate JDBC drivers. It takes the target schema as an argument and checks all the tables in the specified schema in the target database. It will create an output to show which table has added or dropped columns as a csv file. Database connection and metadata retrieval are managed by the Database class."><meta data-rh="true" property="og:description" content="The code uses JDBC for both target and source database connections. You need to compile the code with appropriate JDBC drivers. It takes the target schema as an argument and checks all the tables in the specified schema in the target database. It will create an output to show which table has added or dropped columns as a csv file. Database connection and metadata retrieval are managed by the Database class."><link data-rh="true" rel="icon" href="/img/icon-circle.png"><link data-rh="true" rel="canonical" href="https://mydatahack.com/docs/Web/Java/automate-table-column-comparison"><link data-rh="true" rel="alternate" href="https://mydatahack.com/docs/Web/Java/automate-table-column-comparison" hreflang="en"><link data-rh="true" rel="alternate" href="https://mydatahack.com/docs/Web/Java/automate-table-column-comparison" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="MyDatahack Atom Feed">



<link rel="alternate" type="application/rss+xml" href="/web-technologies/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web-technologies/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/data-engineering/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/data-engineering/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/data-science/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/data-science/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/infrastructure/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/infrastructure/atom.xml" title="MyDatahack Atom Feed"><link rel="stylesheet" href="/assets/css/styles.2668ea1a.css">
<script src="/assets/js/runtime~main.58181399.js" defer="defer"></script>
<script src="/assets/js/main.498d3b66.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon-circle.png" alt="MyDatahack Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/icon-circle.png" alt="MyDatahack Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MyDatahack</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Blogs</a><a class="navbar__item navbar__link" href="/web-technologies">Web Technologies</a><a class="navbar__item navbar__link" href="/data-engineering">Data Engineering</a><a class="navbar__item navbar__link" href="/data-science">Data Science</a><a class="navbar__item navbar__link" href="/infrastructure">Infrastructure</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/takahirohonda" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">index</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/etl">ETL</a><button aria-label="Expand sidebar category &#x27;ETL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/data-ingestion">Data Ingestion</a><button aria-label="Expand sidebar category &#x27;Data Ingestion&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/infrastructure">Infrastructure</a><button aria-label="Expand sidebar category &#x27;Infrastructure&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/web">Web</a><button aria-label="Collapse sidebar category &#x27;Web&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/net">.Net</a><button aria-label="Expand sidebar category &#x27;.Net&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/sitecore">Sitecore</a><button aria-label="Expand sidebar category &#x27;Sitecore&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/frontend">Frontend</a><button aria-label="Expand sidebar category &#x27;Frontend&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/nodejs">Node.js</a><button aria-label="Expand sidebar category &#x27;Node.js&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/java">Java</a><button aria-label="Collapse sidebar category &#x27;Java&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Web/Java/automate-table-column-comparison">Automate Source And Target Table Column Comparison With Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/Java/automate-sf-table-creation">Automate Salesforce Table Creation With Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/Java/get-data-from-ga">How To Get Data From Google Analytics With Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/Java/no-compiler-error">Fixing No Compiler is Provided in this Environment Error for Maven Project with Eclipse</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/git">Git</a><button aria-label="Expand sidebar category &#x27;Git&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/chatgpt-generated">ChatGPT Generated</a><button aria-label="Expand sidebar category &#x27;ChatGPT Generated&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/doc-example/intro">doc-example</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/web"><span itemprop="name">Web</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/java"><span itemprop="name">Java</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Automate Source And Target Table Column Comparison With Java</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Automate Source And Target Table Column Comparison With Java</h1>
<p>The code uses JDBC for both target and source database connections. You need to compile the code with appropriate JDBC drivers. It takes the target schema as an argument and checks all the tables in the specified schema in the target database. It will create an output to show which table has added or dropped columns as a csv file. Database connection and metadata retrieval are managed by the Database class.</p>
<p>The advantage of this design is that you can use the same jar file for multiple data sources as long as you compile the code with JDBC driver. The code is vendor neutral.</p>
<p>The code can be scheduled to run in a server or ETL tool with notification. You can even fetch the csv file and write it to a database table.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code">Code<a href="#code" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h3>
<p>Database.java</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package Database;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.Connection;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.DriverManager;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.SQLException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.Statement;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.ResultSet;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.ResultSetMetaData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Vector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String className;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String connectionUrl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String userName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String passWord;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Database (String cName, String url, String uName, String pName){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        className = cName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        connectionUrl = url;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userName = uName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        passWord = pName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. Create Connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Connection createConnection(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Connection connection = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // (1) Load JDBC Driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Loading JDBC Driver...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Class.forName(className);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;JDBC loaded successfully.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (ClassNotFoundException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // (2) Create connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Connecting to Database ...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            connection = DriverManager.getConnection(connectionUrl, userName, passWord);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (SQLException e){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(e.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return connection;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. Close Connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void closeConnection(Connection conn) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Database Connection Closed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (SQLException e){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(e.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. Get tables in target schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Vector&lt;String&gt; getTables(String sql, int columnIndex, Connection conn) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Vector&lt;String&gt; tables = new Vector&lt;String&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Statement stmt = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ResultSet rs = stmt.executeQuery(sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (rs.next()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                tables.add(rs.getString(columnIndex));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // System.out.println(rs.getString(columnIndex));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (SQLException e){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(e.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return tables;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4. Get Column Metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ArrayList&lt;String&gt; getColumns (String table, String schema, Connection conn) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrayList&lt;String&gt; columns = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Statement stmt = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 4-1 Execute query and get metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String query = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (schema == &quot;None&quot;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                query = &quot;Select * From &quot; + table + &quot; limit 1;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                query = &quot;Select * From &quot; + schema + &quot;.&quot; + table + &quot; limit 1;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ResultSet rs = stmt.executeQuery(query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ResultSetMetaData mt = rs.getMetaData();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int columnCount = mt.getColumnCount();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // System.out.println(&quot;No of Columns is : &quot; + columnCount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 4-2 Get column string and append to ArrayList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            for (int i = 1; i &lt;= columnCount; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                columns.add(mt.getColumnLabel(i).toLowerCase());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (SQLException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(e.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return columns;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Main.java</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package CompareColumn;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileWriter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.PrintWriter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.sql.Connection;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Iterator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Vector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import Database.Database;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CompareColumn {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static ArrayList&lt;String&gt; getAddedColumns(ArrayList&lt;String&gt; source,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            ArrayList&lt;String&gt; target){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrayList&lt;String&gt; addedColumns = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;String&gt; iter = source.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (iter.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String col = iter.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!target.contains(col)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                addedColumns.add(col);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return addedColumns;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static ArrayList&lt;String&gt; getDroppedColumns(ArrayList&lt;String&gt; source,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            ArrayList&lt;String&gt; target){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrayList&lt;String&gt; droppedColumns = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;String&gt; iter = target.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (iter.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String col = iter.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!source.contains(col)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                droppedColumns.add(col);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return droppedColumns;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Set variable from argument</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String targetJDBCClassName = args[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String targetDbUrl = args[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String targetDbUser = args[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String targetDbPass = args[3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String targetSchema = args[4];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sourceJDBCClassName = args[5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sourceDbUrl = args[6];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sourceDbUser = args[7];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sourceDbPass = args[8];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sourceSchema = args[9];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sourceSystem = args[10];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String filePath = args[11];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // (1) Prepare file for writing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FileWriter outFile = new FileWriter(filePath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrintWriter outText = new PrintWriter(outFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outText.println(&quot;&quot;Source&quot;,&quot;Table&quot;,&quot;Descr&quot;,&quot;Columns&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // (2) Connect to database and compare columns between source &amp; target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Database targetDb = new Database(targetJDBCClassName, targetDbUrl,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            targetDbUser, targetDbPass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Connection targetConnection = targetDb.createConnection();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Database sourceDb = new Database(sourceJDBCClassName, sourceDbUrl,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            sourceDbUser, sourceDbPass);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Connection sourceConnection = sourceDb.createConnection();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Vector&lt;String&gt; targetTables = targetDb.getTables(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                String.format(&quot;SELECT table_name FROM information_schema.tables WHERE table_schema = &#x27;%s&#x27;;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                targetSchema), 1, targetConnection);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Iterator&lt;String&gt; ilist = targetTables.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (ilist.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                String tableName = (String) ilist.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(tableName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ArrayList&lt;String&gt; targetColumns = targetDb.getColumns(tableName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    targetSchema, targetConnection);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ArrayList&lt;String&gt; sourceColumns = sourceDb.getColumns(tableName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sourceSchema, sourceConnection);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ArrayList&lt;String&gt; added = getAddedColumns(sourceColumns, targetColumns);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ArrayList&lt;String&gt; dropped = getDroppedColumns(sourceColumns, targetColumns);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (added.size() &gt; 0 ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;Columns added to &quot; + tableName + &quot;: &quot; + added);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    outText.println(String.format(&quot;&quot;%s&quot;,&quot;%s&quot;,&quot;Added&quot;,&quot;%s&quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                sourceSystem, tableName, added));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // System.out.println(&quot;No column added to &quot; + tableName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (dropped.size() &gt; 0 &amp;&amp; dropped.size() &lt; targetColumns.size()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;Columns dropped from &quot; + tableName + &quot;: &quot; + dropped);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    outText.println(String.format(&quot;&quot;%s&quot;,&quot;%s&quot;,&quot;Dropped&quot;,&quot;%s&quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sourceSystem, tableName, dropped));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else if (dropped.size() == targetColumns.size()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    outText.println(String.format(&quot;&quot;%s&quot;,&quot;%s&quot;,&quot;Table Name Mismatch&quot;,&quot;&quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sourceSystem, tableName));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // System.out.println(&quot;No column dropped from &quot; + tableName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outText.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            targetDb.closeConnection(targetConnection);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sourceDb.closeConnection(sourceConnection);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (IOException error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(error);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.exit(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(2017-11-16)</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/java"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Java</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Web/Java/automate-sf-table-creation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Automate Salesforce Table Creation With Java</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#code" class="table-of-contents__link toc-highlight">Code</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/takahirohonda" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 MDH.</div></div></div></footer></div>
</body>
</html>