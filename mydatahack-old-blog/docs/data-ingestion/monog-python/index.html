<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-data-ingestion/monog-python" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">How To Get Data From MongoDB With Python | MyDatahack</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mydatahack.com/docs/data-ingestion/monog-python"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How To Get Data From MongoDB With Python | MyDatahack"><meta data-rh="true" name="description" content="How to get data from MongoDB with Python"><meta data-rh="true" property="og:description" content="How to get data from MongoDB with Python"><link data-rh="true" rel="icon" href="/img/icon-circle.png"><link data-rh="true" rel="canonical" href="https://mydatahack.com/docs/data-ingestion/monog-python"><link data-rh="true" rel="alternate" href="https://mydatahack.com/docs/data-ingestion/monog-python" hreflang="en"><link data-rh="true" rel="alternate" href="https://mydatahack.com/docs/data-ingestion/monog-python" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="MyDatahack Atom Feed">



<link rel="alternate" type="application/rss+xml" href="/web-technologies/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web-technologies/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/data-engineering/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/data-engineering/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/data-science/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/data-science/atom.xml" title="MyDatahack Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/infrastructure/rss.xml" title="MyDatahack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/infrastructure/atom.xml" title="MyDatahack Atom Feed"><link rel="stylesheet" href="/assets/css/styles.2668ea1a.css">
<script src="/assets/js/runtime~main.58181399.js" defer="defer"></script>
<script src="/assets/js/main.498d3b66.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon-circle.png" alt="MyDatahack Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/icon-circle.png" alt="MyDatahack Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MyDatahack</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Blogs</a><a class="navbar__item navbar__link" href="/web-technologies">Web Technologies</a><a class="navbar__item navbar__link" href="/data-engineering">Data Engineering</a><a class="navbar__item navbar__link" href="/data-science">Data Science</a><a class="navbar__item navbar__link" href="/infrastructure">Infrastructure</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/takahirohonda" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">index</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/etl">ETL</a><button aria-label="Expand sidebar category &#x27;ETL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/data-ingestion">Data Ingestion</a><button aria-label="Collapse sidebar category &#x27;Data Ingestion&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/s3-data-node-1">Event-Driven S3 Data Ingestion With Node.js Lambda Function and Deploy it with Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/s3-data-ruby">Uploading and Downloading Files in S3 with Ruby</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/s3-data-node-2">Uploading and Downloading Files in S3 with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/mongo-node-1">How to Ingest Data Into MongoDB with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/mong-node-2">How to Ingest Data From MongoDB with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/rest-api-node">REST API Data Ingestion with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/json-to-csv-to-pg-node">Converting JSON to CSV and Loading it to Postgres with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/csv-to-json-pg-node">Converting CSV to JSON and Loading it to Postgres with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/bulk-load-pg-node">Bulk Loading Postgres with Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/json-with-python">A Comprehensive Guide for Reading and Writing JSON with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/fullstory-data-python">How to Ingest FullStory Data Export Extracts with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/jdbc-python">How to Bulk Load Data with JDBC and Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/odbc-python">How to Bulk Load Data with ODBC and Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/mysql-python">How to Bulk Load Data into MySQL with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/pg-python">How to Bulk Load Data into PostgreSQL with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/lambda-s3-rds-python">Event-Driven Data Ingestion with AWS Lambda (S3 to RDS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/lambda-s3-s3-python">Event-Driven Data Ingestion with AWS Lambda (S3 to S3)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/s3-python">Comprehensive Guide to Download Files From S3 with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/pg-json">New JSON Data Ingestion Strategy by Using the Power of Postgres</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/aes-encrypted-data-python">How To Ingest AES Encrypted Data With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/convert-non-utc-to-unix-python">How To Convert Non-UTC Timestamp Into UNIX Epoch Time In Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/data-ingestion/monog-python">How To Get Data From MongoDB With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/liveperson-data-r">How To Get Data From Liveperson And Create Aggregated Table With R</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/liveperson-python">How To Ingest Data From Liveperson With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/sharepoint-python">How To Get Data From SharePoint With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/qualtrics-python">How To Get Survey Response Data From Qualtrics With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/s3-redshift-py">Data Engineering in S3 and Redshift with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/ga-py">How To Get Data From Google Analytics With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/facebook-py">How To Get Facebook Data With Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-ingestion/twitter-py">How To Get Twitter Data With Python</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/infrastructure">Infrastructure</a><button aria-label="Expand sidebar category &#x27;Infrastructure&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/web">Web</a><button aria-label="Expand sidebar category &#x27;Web&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/git">Git</a><button aria-label="Expand sidebar category &#x27;Git&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/chatgpt-generated">ChatGPT Generated</a><button aria-label="Expand sidebar category &#x27;ChatGPT Generated&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/doc-example/intro">doc-example</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/data-ingestion"><span itemprop="name">Data Ingestion</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How To Get Data From MongoDB With Python</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>How To Get Data From MongoDB With Python</h1>
<p>How to get data from MongoDB with Python</p>
<p>MongoDB is one of the most popular no SQL databases used as a backend database for web and mobile applications. Data is stored in MongoDB as BSON, which looks like JSON files. Once you understand the way MongoDB stores data, all you need to do is to connect to the database, query the data and convert it into a structured file with the same way as we do with JSON files.</p>
<p>Here are two useful MongoDB tutorials for beginners: Learn Mongo DB from Tutorial Point and Getting Started with MongoDB from the official website. The pymongo package makes it really easy for us to use Python with MongoDB. I recommend PyMongo documentation for getting stated. If you are having trouble with connection like authentication, Conncet to MongoDB via the Python Driver from the official website has a detailed examples and explanations that help you to troubleshoot your code.</p>
<p>In this post, I will use the official MongoDB example dataset and show you how to grab data from MongoDB, convert it into structured tables and load them to Postgres database.</p>
<p>Setting up MongoDB
First of all, let’s install MongoDB, create the test database and user credential with the right privilege and upload an example data set, restaurants into the test.</p>
<p>Steps</p>
<p>(1) Donwload the community server from MongoDB Download Center and install it. The key point for Windows installation is to create a data directory to set up the environment.</p>
<p><code>mkdir c:\data\db</code></p>
<p>(2) Once the installation is completed, start the database. In Windows, I just use the mongod command to start the server.</p>
<p><code>mongod</code></p>
<p>(3) There are a few good user interface available out there. My favorite is Robo 3T. MongoDB Compass comes with MonogDB installation and is good enough for a starter. By default, you will have admin and local databases for Windows installation. Open your command line interface and bring up the mongo db command line interface client by typing mongo.</p>
<p>(4) You can use various commands to do administrative tasks and run queries from the command line interface. Let’s create a new user called admin with password as Password1.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">db.createUser( { user: &quot;admin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 pwd: &quot;Password1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 customData: { employeeId: 12345 },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 roles: [ { role: &quot;clusterAdmin&quot;, db: &quot;admin&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          { role: &quot;readAnyDatabase&quot;, db: &quot;admin&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          &quot;readWrite&quot;] },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               { w: &quot;majority&quot; , wtimeout: 5000 } )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(5) Create a new database called test. The ‘use’ command is used to switch to different databases. If no database exists, it creates the database. You can also use show dbs to check all the existing databases and show collections to check all the collections existing in the current database you are in.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> dbs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> collections</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(6) You can now use the command line interface with the newly created credential.</p>
<p><code>mongo --host localhost --port 27017 -u admin -p Password1</code></p>
<p>(7) Download the restaurant data as a json file and then upload it to the test database with the mongoimport command. The dataset can be downloaded here.</p>
<p><code>mongoimport --db test --collection restaurants --drop --file C:\Users\test\Downloads\primer-dataset.json</code></p>
<p>(8) Once it’s imported, try to query some data (query examples below). If it works, we are now ready to ingest the restaurant collection with Python.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">db.restaurants.find().limit(10).pretty()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db.restaurants.find({&quot;restaurant_id&quot;:&quot;30191841&quot;}).pretty()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Quick Starter Guide to pymongo</p>
<p>With pymongo, we can connect to MongoDB and query the records. Here is the quick code example for connecting to MongoDB, querying the first 10 records and printing the result to the console in the pretty format.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pymongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pymongo </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MongoClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pprint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MongoClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;mongodb://admin:Password1@localhost:27017/test&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">restaurants </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restaurants</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Total Record for the collection: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">restaurants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> record </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> restaurants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">limit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     pprint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pprint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Data Model</strong></p>
<p>Here is an example of a document (meaning a row record) from the restaurant collection (meaning table).</p>
<p><img decoding="async" loading="lazy" alt="data model" src="data:image/webp;base64,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" width="967" height="560" class="img_ev3q"></p>
<p>As you can see, the collection is denormalised as the grade fields are nested. To convert it into a relational database table, it is better to normalise it. My suggestion is to create the main restaurant table and child grades table with id as the foreign key.</p>
<p><img decoding="async" loading="lazy" alt="record example" src="data:image/webp;base64,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" width="650" height="612" class="img_ev3q"></p>
<p>You can create table in Postgres as below. In the database, I set up a schema called mongodb.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restaurants </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address_building </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address_coord1 </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address_coord2 </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address_street </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address_zipcode </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address_borough </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cuisine </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restaurant_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grades </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REFERENCES</span><span class="token plain"> mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restaurants </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grade </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    score </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Python Code</p>
<p>It’s time for coding!</p>
<p>(1) You need to import pymongo and psycopg2 packages.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pymongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pymongo </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MongoClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> psycopg2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(2) Grab the query results and convert it into a list that contains a list of row record. Return the record list and the header list. You need to handle the index out of bound error for corrdinates.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create_restaurants</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Take the query outcome and convert to a list and return it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    It also defines headers and return it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    records </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> record </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;address_building&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;address_coord1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;address_coord2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;address_street&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;address_zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;address_borough&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;cuisine&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;name&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;restaurant_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;(&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;address&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;building&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;coord&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> IndexError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;NA&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;coord&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> IndexError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;NA&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;street&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;borough&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;cuisine&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;name&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;restaurant_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        records</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Preped restaurant table.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> records</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create_grades</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Take the query outcome and convert to a list and return it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    It also defines headers and return it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    records </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;date&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;grade&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;score&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> record </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> grade </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;grades&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;_id&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;(&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">grade</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;date&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;(&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;T&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Z&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">grade</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;grade&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tmp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">grade</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;score&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            records</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> records</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(3) Create a csv file for each table with double quotes. Double quotes are important because some records contain comma. encoding=’utf-8′ is for Python 3. For Python 2, you can set default encoding as below.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">reload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">setdefaultencoding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">“utf</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">8</span><span class="token plain">”</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">records</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Take a list of records and headers and generate csv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row_len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">headers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">format_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">headers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> row_len</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> record </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> records</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">format_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> row_len</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;CSV file successfully created: {}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">format_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> delimiter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> record </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> length</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> quote </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> record </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> quote </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> quote </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> record </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> quote </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> delimiter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> string</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(4) Load csv file to postgres. I am using the copy_expert function because it has a better control. For example, using copy_from() will not ignore double quotes when you load data. You can check documentations here for further details. I have Postgres installed on my local computer. I created a database called mydatahack and credentials with username as mydatahack and password as Password1. The user was then added to the user group postgres which is the default credential comes with postgres when you install it.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pg_load_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        conn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> psycopg2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;dbname=&#x27;mydatahack&#x27; user=&#x27;mydatahack&#x27; host=&#x27;localhost&#x27; password=&#x27;Password1&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Connecting to Database&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cur </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cursor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;r&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cur</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Truncate {} Cascade;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Truncated {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cur</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy_expert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;copy {} from STDIN CSV HEADER&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cur</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;commit;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Loaded data into {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;DB connection closed.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(5) Let’s put them all together and execute it.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (1) Connect to MongoDB instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MongoClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;mongodb://admin:Password1@localhost:27017/test&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (2) Choose database and create the db object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (3) Choose the collection and create Collection Object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restaurants </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restaurants</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Total Record for the collection: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">restaurants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (4) Retrieve all data from the restaurants collection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> restaurants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (4-1) Transform data into a structured tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rest_tup </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> create_restaurants</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rest_records </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rest_tup</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rest_headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rest_tup</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    create_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rest_records</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rest_headers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./restaurants.csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (5) Retrive all data again for grades</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> restaurants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (5-1) Transform data for grades</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grades_tup </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> create_grades</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grades_records </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> grades_tup</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grades_headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> grades_tup</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    create_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">grades_records</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grades_headers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./grades.csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (6) Load data into Postgres</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pg_load_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./restaurants.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mongodb.restaurants&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pg_load_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./grades.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mongodb.grades&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once the data is loaded into the postgres, you can use it to analyse the data. For example, calculating the average grade per restaurant and rank them with SQL will be fun.</p>
<p>(2017-12-22)</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/data-ingestion/convert-non-utc-to-unix-python"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How To Convert Non-UTC Timestamp Into UNIX Epoch Time In Python</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/data-ingestion/liveperson-data-r"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How To Get Data From Liveperson And Create Aggregated Table With R</div></a></nav></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/takahirohonda" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 MDH.</div></div></div></footer></div>
</body>
</html>