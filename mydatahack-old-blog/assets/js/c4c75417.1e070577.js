"use strict";(self.webpackChunkmydatahack_blog_site=self.webpackChunkmydatahack_blog_site||[]).push([[4507],{92728:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>i});var t=o(74848),r=o(28453);const s={sidebar_position:16},c="MongoDB CRUD Operation with Node.js",l={id:"Web/Node.js/mongo-curd-nodejs",title:"MongoDB CRUD Operation with Node.js",description:"Once you get your head around MongoDB CRUD operations with Mongo Shell, getting Node.js to do them becomes easy. If you are still not confident with MongoDB, check out MongoDB skills essentials exercise to brush up your MongoDB skills.",source:"@site/docs/Web/Node.js/16.mongo-curd-nodejs.md",sourceDirName:"Web/Node.js",slug:"/Web/Node.js/mongo-curd-nodejs",permalink:"/mydatahack-old-blog/mydatahack-old-blog/Web/Node.js/mongo-curd-nodejs",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:16,frontMatter:{sidebar_position:16},sidebar:"tutorialSidebar",previous:{title:"Website Page Routing with Node.js Express and EJS",permalink:"/mydatahack-old-blog/mydatahack-old-blog/Web/Node.js/page-routing-nodejs-express-and-ejs"},next:{title:"Java",permalink:"/mydatahack-old-blog/mydatahack-old-blog/category/java"}},a={},i=[];function d(e){const n={code:"code",h1:"h1",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"mongodb-crud-operation-with-nodejs",children:"MongoDB CRUD Operation with Node.js"}),"\n",(0,t.jsx)(n.p,{children:"Once you get your head around MongoDB CRUD operations with Mongo Shell, getting Node.js to do them becomes easy. If you are still not confident with MongoDB, check out MongoDB skills essentials exercise to brush up your MongoDB skills."}),"\n",(0,t.jsx)(n.p,{children:"We will create a collection called, students. Then, we will insert records, update a record, remove a record and query all records in a single go. You can use the same syntax as what you would use in Mongo Shell in Node.js. The biggest difference is that each function is asynchronous and you have to use a callback function with the error-first signature."}),"\n",(0,t.jsx)(n.p,{children:"By doing all the CRUD operations in one go, you get to do a lot of callbacks. It will be fun."}),"\n",(0,t.jsx)(n.p,{children:"Here comes the code!"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const MongoClient = require("mongodb").MongoClient;\nconst url = "mongodb://writer:Password1@localhost:27017/admin";\n\n// Data\nconst initialData = [\n  {\n    studentId: 1,\n    firstName: "John",\n    lastName: "West",\n    Major: "Psychology",\n  },\n  {\n    studentId: 2,\n    firstName: "Allen",\n    lastName: "Doe",\n    Major: "Science",\n  },\n  {\n    studentId: 3,\n    firstName: "Shane",\n    lastName: "West",\n    Major: "IT",\n  },\n];\n\n// (1) Insert the initial data\nconst insertStudent = (collection, callback) => {\n  collection.insert(initialData, (err, result) => {\n    if (err) {\n      console.error(`Insertion error ${err}`);\n      process.exit(1);\n    }\n    console.log(`No of records: ${result.result.n}`);\n    callback(result);\n  });\n};\n\n// (2) Update John\'s Major to Literature\nconst updateStudent = (collection, callback) => {\n  collection.update(\n    { studentId: 1 },\n    { $set: { Major: "Literature" } },\n    (err, results) => {\n      if (err) {\n        console.error(`Update error: ${err}`);\n        process.exit(1);\n      }\n      console.log(`Record updated successfully.`);\n      callback(results);\n    }\n  );\n};\n\n// (3) Remove studentId=3\nconst removeStudent = (collection, callback) => {\n  collection.remove({ studentId: 3 }, (err, results) => {\n    if (err) {\n      console.error(`Remove record error: ${err}`);\n      process.exit(1);\n    }\n    console.log(`Record removed successfully.`);\n    callback(results);\n  });\n};\n\n// (4) Query all records\nconst getStudents = (collection, callback) => {\n  collection.find({}).toArray((err, data) => {\n    if (err) {\n      console.error(`Cannot find student records: ${err}`);\n      process.exit(1);\n    }\n    console.log(`Record count: ${data.length}`);\n    console.log(data);\n    callback(data);\n  });\n};\n\n// (5) Put them all together\nMongoClient.connect(url, (err, client) => {\n  if (err) {\n    console.error(`Connection Error: ${err}`);\n    return process.exit(1);\n  }\n  console.log(`Connection Successful`);\n  const db = client.db("usermanaged");\n  const collection = db.collection("students");\n  insertStudent(collection, () => {\n    updateStudent(collection, () => {\n      removeStudent(collection, () => {\n        getStudents(collection, () => {\n          client.close();\n          console.log("DB connection closed.");\n        });\n      });\n    });\n  });\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"(2018-04-25)"})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>l});var t=o(96540);const r={},s=t.createContext(r);function c(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);